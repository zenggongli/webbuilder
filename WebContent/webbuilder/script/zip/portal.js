var Pt={load:function(a,b){if(a&&a.saveUrl&&(b||!a.moduleLoaded)){var d=a.iframeId,c=Wb.dom(d);c.style.visibility="hidden";Wb.submit(a.saveUrl,a.params,d,a.openType);c.style.visibility="visible";a.moduleLoaded=true}},moduleTabChange:function(b,a){if(a==homePage){Pt.openHome()}else{Pt.load(a)}},run:function(b){if(!b.get("IS_FOLDER")){Pt.savePath();var a="main?xwl="+b.get("MODULE_ID");if(b.get("NEW_WIN")){window.open(a)}else{WBXwlOpen(a,b.get("text"),b.get("iconCls"))}}},viewConfig:function(){return{plugins:{pluginId:"ddPlug",ptype:"treeviewdragdrop",ddGroup:"portal",enableDrop:false}}},savePath:function(){if(Pt.pathSaving||Pt.indexPath==="-"){return}var b=Wb.getSelNode(moduleTree),a;if(b){a=b.getPath("MODULE_ID","\n");if(a===Pt.savedPath){return}Pt.savedPath=a;Pt.pathSaving=1;Ext.Ajax.request({url:"main?xwl=13NOEQY1P3LO",params:{path:a},callback:function(){delete Pt.pathSaving}})}},open:function(d,c,l,o,e,i,m,k,n,g){if(e==null&&m===undefined){var j=false;d.items.each(function(b){if(b.saveUrl===c){d.setActiveTab(b);j=true;return false}});if(j){return false}}var a="xi_"+Wb.getId(),f,p;f={iconCls:o,saveUrl:c,iframeId:a,layout:"fit",params:e,hideMode:"offsets",openType:i,title:Wb.ellipsis(l),orgTitle:l,listeners:{render:function(b){if(b.title!==b.orgTitle){b.ellipsisTip=new Ext.tip.ToolTip({target:b.tab.btnWrap,html:l})}},beforeclose:function(h){var s,q,b=Wb.dom(h.iframeId).contentWindow;if(!b.wb_forceCls){s=b.wb_beforeunload;q=s?s():null;if(q!==null&&q!==undefined){Wb.confirm(q+"<br>"+Str.closeConfirm,function(){b.wb_forceCls=true;h.close()});return false}}},beforedestroy:function(b){try{var s=b.iframeId,h=Wb.dom(s),r=h.contentWindow.document||h.contentDocument||window.frames[s].document;h.src="";r.write("");r.close();Ext.fly(h).destroy();Wb.closeNav(backBtn,forwardBtn,b)}catch(q){}}},closable:true,html:'<iframe id="'+a+'" name="'+a+'" scrolling="auto" frameborder="0" width="100%" height="100%"></iframe>'};if(m===undefined){p=d.add(f)}else{Ext.apply(f,{x:m<0?0:m,y:k<0?0:k,width:n||380,height:g||260,liveDrag:true,autoShow:true,floating:false,bodyStyle:"background-image:none;background-color:#FFFFFF",resizable:{listeners:{beforeresize:function(){var b=this;if(!b.setMouseUp){b.setMouseUp=true;b.resizeTracker.on({mouseup:function(){Ext.fly(Wb.dom(a)).removeCls("x-hide-offsets")}})}Ext.fly(Wb.dom(a)).addCls("x-hide-offsets")}}},draggable:{listeners:{dragstart:function(){Ext.fly(Wb.dom(a)).addCls("x-hide-offsets")},dragend:function(){Ext.fly(Wb.dom(a)).removeCls("x-hide-offsets")}}},tools:[{type:"refresh",handler:function(){Pt.load(p,true)}},{type:"maximize",handler:function(){moduleTab.setActiveTab(Pt.open(moduleTab,p.saveUrl,p.orgTitle,p.iconCls))}}],xtype:"window"});p=d.add(f)}return p},logout:function(){var d,a=false;homePage.items.each(function(b){d=Wb.dom(b.iframeId).contentWindow.wb_beforeunload;if(d){d=d();if(!a&&d!==null&&d!==undefined){moduleTab.setActiveTab(homePage);a=true}}});moduleTab.items.each(function(b){if(b!=homePage){d=Wb.dom(b.iframeId).contentWindow.wb_beforeunload;if(d){d=d();if(!a&&d!==null&&d!==undefined){moduleTab.setActiveTab(b);a=true}}}});function c(){Wb.request({url:"main?xwl=logout",success:function(){Pt.canLogout=true;window.location="main"}})}if(a){Wb.confirm(Str.closeConfirm,c)}else{c()}},close:function(b){var c,a=moduleTab;c=a.getActiveTab();a.items.each(function(d){if(d!=homePage&&(b||c!=d)){d.close()}})},monDbClick:function(){var a=moduleTab.getActiveTab();if(a.saveUrl&&!a.params){window.open(a.saveUrl)}},ddSupport:function(a){new Ext.dd.DropTarget(a.body.dom,{ddGroup:"portal",notifyDrop:function(f,d,c){var b=d.getX()-a.body.getLeft(),h=d.getY()-a.body.getTop(),g=c.records[0];if(!g.get("IS_FOLDER")){Pt.load(Pt.open(a,"main?xwl="+g.get("MODULE_ID"),g.get("text"),g.get("iconCls"),null,null,b,h));return true}}})},getDesktop:function(){var d,b=moduleTab.items.length,c,a=[],e;e=[{width:moduleTree.getWidth(),index:moduleTab.items.indexOf(moduleTab.getActiveTab())}];b=homePage.items.length;for(d=0;d<b;d++){c=homePage.items.items[d];if(c.saveUrl){a.push({url:c.saveUrl,title:c.orgTitle,icon:c.iconCls,x:c.x,y:c.y,w:c.width,h:c.height})}}e.push(a);b=moduleTab.items.length;for(d=1;d<b;d++){c=moduleTab.items.items[d];e.push({url:c.saveUrl,title:c.title,icon:c.iconCls})}return Ext.encode(e)},initialize:function(){Wd.WBXwlOpen=function(a,e,b,d,c){moduleTab.setActiveTab(Pt.open(moduleTab,a,e,b,d,c))}},finalize:function(){if(desktopData!=null){var f=desktopData,a=f[1],c,b,e;moduleTree.setWidth(f[0].width);b=a.length;for(c=0;c<b;c++){e=a[c];Pt.open(homePage,e.url,e.title,e.icon,null,null,e.x,e.y,e.w,e.h)}b=f.length;for(c=2;c<b;c++){e=f[c];Pt.open(moduleTab,e.url,e.title,e.icon)}c=f[0].index;if(c==0){Pt.openHome()}else{moduleTab.setActiveTab(c)}}},openHome:function(){var a=homePage.items,c,b=a.length;for(c=0;c<b;c++){Pt.load(a.items[c])}},refresh:function(){var d=moduleTab.getActiveTab(),c,b,a;if(d==homePage){a=homePage.items;b=a.length;for(c=0;c<b;c++){Pt.load(a.items[c],true)}}else{Pt.load(d,true)}}};